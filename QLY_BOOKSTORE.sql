CREATE DATABASE QL_BOOKSTORE


USE QL_BOOKSTORE
GO

CREATE TABLE TACGIA
(
	MATG VARCHAR (50) PRIMARY KEY,
	TENTG NVARCHAR (100),
	DIACHI NVARCHAR (100),
	DIENTHOAI  VARCHAR (12),
);

CREATE TABLE NHAXUATBAN
(
	MANXB VARCHAR (50) PRIMARY KEY,
	TENNXB NVARCHAR (100),
	DIACHI NVARCHAR (100),
	DIENTHOAI VARCHAR (12),
);

CREATE TABLE CHUDE
(
	MACD VARCHAR (50) PRIMARY KEY,
	TENCHUDE NVARCHAR (100),
);



CREATE TABLE SACH
(
	MASACH VARCHAR (50) PRIMARY KEY,
	TENSACH NVARCHAR (100),
	GIABAN NUMERIC,
	MOTA NVARCHAR (100),
	ANHBIA VARCHAR (100),
	NGAYCAPNHAT DATE,
	MACHUDE VARCHAR (50),
	MANXB VARCHAR (50),
	FOREIGN KEY (MACHUDE) REFERENCES CHUDE (MACD),
	FOREIGN KEY (MANXB) REFERENCES NHAXUATBAN(MANXB),
);



CREATE TABLE VIETSACH
(
	MATG VARCHAR (50),
	MASACH VARCHAR (50),
	PRIMARY KEY (MATG,MASACH),
	FOREIGN KEY (MATG) REFERENCES TACGIA (MATG),
	FOREIGN KEY (MASACH) REFERENCES SACH (MASACH),
);


CREATE TABLE KHACHHANG
(
	MAKH VARCHAR (100) PRIMARY KEY,
	HOTEN NVARCHAR (100),
	TAIKHOAN VARCHAR (100),
	MATKHAU VARCHAR (20),
	EMAIL VARCHAR (20),
	DIACHI NVARCHAR (50),
	DIENTHOAI NVARCHAR (12),
	NGAYSINH DATE,
);

CREATE TABLE DONDATHANG
(
	MADON VARCHAR (100) PRIMARY KEY,
	DATHANHTOAN BIT,
	TINHTRANGGIAO BIT,
	NGAYDAT DATE,
	NGAYGIAO DATE,
	MAKH VARCHAR (100),

	FOREIGN KEY (MAKH) REFERENCES KHACHHANG (MAKH),
);


CREATE TABLE CHITIETDONHANG
(
	MADONHANG VARCHAR (100),
	MASACH VARCHAR (50),
	PRIMARY KEY(MADONHANG,MASACH),
	SOLUONG INT,
	DONGIA DECIMAL,
	FOREIGN KEY (MASACH) REFERENCES SACH(MASACH),
	FOREIGN KEY (MADONHANG) REFERENCES DONDATHANG (MADON)
);




-- Bảng TÁC GIẢ
INSERT INTO TACGIA VALUES 
('TG01', N'Nguyễn Nhật Ánh', N'TP.HCM', '0901234567'),
('TG02', N'Trần Đăng Khoa', N'Hà Nội', '0912345678'),
('TG03', N'Ngô Tất Tố', N'Bắc Ninh', '0987654321');

-- Bảng NHÀ XUẤT BẢN
INSERT INTO NHAXUATBAN VALUES 
('NXB01', N'NXB Trẻ', N'TP.HCM', '0281234567'),
('NXB02', N'NXB Kim Đồng', N'Hà Nội', '0249876543'),
('NXB03', N'NXB Giáo Dục', N'Đà Nẵng', '0236789123');

-- Bảng CHỦ ĐỀ
INSERT INTO CHUDE VALUES 
('CD01', N'Thiếu nhi'),
('CD02', N'Văn học'),
('CD03', N'Giáo dục');

-- Bảng SÁCH
INSERT INTO SACH VALUES 
('S01', N'Tôi thấy hoa vàng trên cỏ xanh', 85000, N'Truyện thiếu nhi nổi tiếng', 'hoa_vang.jpg', '2023-10-01', 'CD01', 'NXB01'),
('S02', N'Đất rừng phương Nam', 90000, N'Truyện phiêu lưu', 'dat_rung.jpg', '2023-10-02', 'CD01', 'NXB02'),
('S03', N'Tắt đèn', 70000, N'Tác phẩm hiện thực phê phán', 'tat_den.jpg', '2023-10-03', 'CD02', 'NXB03');

-- Bảng VIẾT SÁCH (liên kết tác giả - sách)
INSERT INTO VIETSACH VALUES 
('TG01', 'S01'),
('TG02', 'S02'),
('TG03', 'S03');

-- Bảng KHÁCH HÀNG
INSERT INTO KHACHHANG VALUES 
('KH01', N'Lê Minh Tuấn', 'tuanle', '12345', 'tuan@gmail.com', N'Đà Nẵng', '0901111222', '1995-02-15'),
('KH02', N'Nguyễn Thị Hoa', 'hoanguyen', 'abc123', 'hoa@gmail.com', N'Hà Nội', '0903333444', '2000-06-20'),
('KH03', N'Trần Văn Bình', 'binhtran', 'binhpass', 'binh@gmail.com', N'TP.HCM', '0905555666', '1998-11-05');

-- Bảng ĐƠN ĐẶT HÀNG
INSERT INTO DONDATHANG VALUES 
('DH01', 1, 0, '2024-10-10', '2024-10-15', 'KH01'),
('DH02', 0, 0, '2024-10-12', NULL, 'KH02'),
('DH03', 1, 1, '2024-10-13', '2024-10-18', 'KH03');

-- Bảng CHI TIẾT ĐƠN HÀNG
INSERT INTO CHITIETDONHANG VALUES 
('DH01', 'S01', 2, 85000),
('DH02', 'S02', 1, 90000),
('DH03', 'S03', 3, 70000);

select * from sach

